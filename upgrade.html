<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
 | Generated by Apache Maven Doxia at Jun 17, 2015
 | Rendered using Apache Maven Fluido Skin 1.2.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NBM Maven Plugin - Maven 2 NBM Plugin</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido.min.js"></script>

    
      <meta name="author" content="Milos Kleint
mkleint@codehaus.org" />
    <meta name="Date-Revision-yyyymmdd" content="20150617" />
    <meta http-equiv="Content-Language" content="en" />
    
        </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href="../../" id="bannerLeft">
                                                                                                <img src="../../images/mojo_logo.png"  alt="Mojo"/>
                </a>
                      </div>
        <div class="pull-right">                  <a href="http://codehaus.org/" id="bannerRight">
                                                                                                <img src="../../images/codehaus-small.png"  alt="Codehaus"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="http://codehaus.org/" class="externalLink" title="Codehaus">Codehaus</a>
        <li class="divider ">/</li>
      </li>
            <li class="">
                    <a href="../../" title="Mojo">Mojo</a>
        <li class="divider ">/</li>
      </li>
            <li class="">
                    <a href="../" title="NBM Maven Parent">NBM Maven Parent</a>
        <li class="divider ">/</li>
      </li>
                <li class="">
                    <a href="./" title="NBM Maven Plugin">NBM Maven Plugin</a>
        <li class="divider ">/</li>
      </li>
    <li class="">NBM Maven Plugin - Maven 2 NBM Plugin</li>
      
                
                    
                  <li id="publishDate" class="pull-right">Last Published: 2015-06-17</li> <li class="divider pull-right">|</li>
              <li id="projectVersion" class="pull-right">Version: 3.14</li>
            
                                  <li class="divider pull-right">|</li>
                      
    <li class="pull-right">              <a href="http://maven.apache.org/" class="externalLink" title="Maven">Maven</a>
  </li>

                        </ul>
      </div>

            <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                                    <h3>Overview</h3>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Usage">Usage</a>
            </li>
                  <li class="none">
                          <a href="plugin-info.html" title="Plugin Goals">Plugin Goals</a>
            </li>
          </ul>
                        <h3>HOWTOs</h3>
                  <ul>
                  <li class="none">
                          <a href="buildinstexample.html" title="Customize installers">Customize installers</a>
            </li>
                  <li class="none">
            <strong>Upgrade from older versions</strong>
          </li>
          </ul>
                        <h3>Deprecated</h3>
                  <ul>
                  <li class="none">
                          <a href="nbm.html" title="Descriptor Format">Descriptor Format</a>
            </li>
                  <li class="none">
                          <a href="descriptor.html" title="Example Descriptor">Example Descriptor</a>
            </li>
          </ul>
                        <h3>Project Documentation</h3>
                  <ul>
                                                                                                                                                                                                                                      <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                                                                                                                                                          <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                      
                    
                            <form id="search-form" action="http://www.google.com/search" method="get" >
    
  <input value="mojo.codehaus.org" name="sitesearch" type="hidden"/>
  <input class="span2 search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=search-form"></script>
          
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section"><h2>HOW TO: Migrate from older version of the plugin<a name="HOW_TO:_Migrate_from_older_version_of_the_plugin"></a></h2><p><a href="#Upgrading_to_3.9"> Upgrading to 3.9</a></p><p><a href="#Upgrading_to_3.8"> Upgrading to 3.8</a></p><p><a href="#Upgrading_from_2.6_version_to_3.0"> Upgrading from 2.6 to 3.0</a></p><p><a href="#Upgrading_from_2.4_version_to_2.5"> Upgrading from 2.4 to 2.5</a></p></div><div class="section"><h2><a name="Upgrading_to_3.9">Upgrading to 3.9</a></h2></div><div class="section"><h2>In 3.9, the <i>code</i>populate-repository<i>/code</i> goal is moved to separate plugin.<a name="In_3.9_the_codepopulate-repositorycode_goal_is_moved_to_separate_plugin."></a></h2></div><div class="section"><h2><a name="Upgrading_to_3.8">Upgrading to 3.8</a></h2><p>In 3.8 the <i>code</i>descriptor<i>/code</i> parameter is deprecated and is replaced by equivalent plugin parameters. The values from descriptor are still applied, warnings are printed. In future releases the parameter will be removed.</p></div><div class="section"><h2><a name="Upgrading_from_2.6_version_to_3.0">Upgrading from 2.6 version to 3.0</a></h2><p>There are a few significant incompatible changes introduced in <b>3.0's</b> version of NBM packaging lifecycle. The result should be easier to setup builds and better support for building NetBeans platform based applications.</p><ul><li>The lifecycle mappings have changed. There is no more <tt>nbm:jar</tt> goal and it was replaced by <tt>nbm:manifest</tt> which is executed at different phase, namely <tt>process-classes</tt>, right after the module's classes are compiled.</li></ul><p><b>Important</b>: In order to have maven-jar-plugin to pick up the generated manifest, you need to add the following configuration snippet to your projects with <tt>nbm</tt> packaging.</p><div class="source"><pre class="prettyprint">    &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.2&lt;/version&gt;
        &lt;configuration&gt;
            &lt;useDefaultManifestFile&gt;true&lt;/useDefaultManifestFile&gt;
        &lt;/configuration&gt;
    &lt;/plugin&gt;</pre></div><ul><li>The project's dependencies that shall end up on <b>Class-Path</b> of the module and now processed transitively. In earlier versions, you had to either explicitly list all such items in the pom as direct dependencies, or list them in the module descriptor. Only transitive dependencies that descend from non-NetBeans module direct dependencies are included, eg. if you depend on module that includes Apache's commons-httpclient, the library will not be included (unless defined in your project directly). Possible trouble makers are transitive depedencies that are defined both in a dependening module and a regular jar dependency. Based on Maven dependency tree resolution, the binary could end up on the <b>Class-Path</b> or not. The resolution to the problem is to define The troubled dependency directly and either define the scope as <tt>provided</tt> if you don't want it included in <b>Class-Path</b>, or keep the default <tt>compile</tt> scope if you want.</li><li>NBM file is always generated for any NetBeans module project. You can skip the NBM file generation by setting the parameter to nbm:nbm goal, but please be aware that having NBM files in local and remote repositories is crucial for the new tools that create a NetBeans Platform based application binaries.</li><li>In previous versions the ultimate final binary for the platform based application, was a directory with the cluster(s) of modules. Now a new packaging is defined <tt>nbm-application</tt> that allows for creating a final application zip file, webstartable jnlp files, and an update site. All are constructed solely from the repository content (assuming all relevant modules have NBM files in repositories) and the primary project for the binaries is the <tt>nbm-application</tt> packaging project, unlike in previous versions where the root pom was the primary project and required all included modules to be built as part of the reactor in the same build.</li><li>The <tt>nbm:manifest</tt> goal besides generating the manifest, will also check if the runtime dependencies match the actual classes being used in the project and it's libraries on <b>Class-Path</b>. That's analogous to the <a class="externalLink" href="http://maven.apache.org/plugins/maven-dependency-plugin/analyze-mojo.html"><tt>dependency:analyze</tt></a> goal but takes the NetBeans module system constraints into account (non-transitivity of module dependencies, public vs. private packages constraint etc)</li><li>The previous versions didn't define the <tt>OpenIDE-Module-Public-Packages</tt> entry in the manifest file. The result was a deprecated state that made all classes publicly accessible from other modules and printed a warning to the application's log file. In <b>3.0</b>, we introduced a new optional parameter <tt>publicPackages</tt> that lists all public packages in the module. If not defined, no package is exported as public. See <a class="externalLink" href="http://jira.codehaus.org/browse/MNBMODULE-32">issue MNBMODULE-32</a> for details. If you have previously placed the <b>OpenIDE-Module-Public-Packages</b> entry in the manifest file manually, it will not be overriden by the new parameter.<hr /></li></ul></div><div class="section"><h2><a name="Upgrading_from_2.4_version_to_2.5">Upgrading from 2.4 version to 2.5</a></h2><p>There are significant changes in how NetBeans module system dependencies are mapped to maven's own dependencies model. The <b>2.4</b> and older version all module system deps had to be explicitly defined in the module descriptor at <tt>src/main/nbm/module.xml</tt>. That is no longer a requirement in <b>2.5</b> for most cases. The plugin will try to decide based on the declaration in maven POM file. </p><p>These are the rules:</p><ul><li>for NetBeans module dependencies (jars that have the NetBeans specific entries in META-INF/MANIFEST.MF)<ul><li>It's defined in existing (though optional) <tt>module.xml</tt> file in <tt>dependencies</tt> section.</li><li>It's a direct dependency (non-transitive) and is a NetBeans module.</li><li>When the dependency is of type <tt>nbm</tt>. Such dependencies don't include their transitive deps on compilation classpath.</li></ul></li><li>for module libraries (jars that are packed together with the module and appear on it's classpath directly, not by a dependency relationship.)<ul><li>It's defined in existing (though optional) <tt>module.xml</tt> file in <tt>libraries</tt> section</li><li>It's a direct dependency (non-transitive) and is not of <tt>provided</tt> scope.</li></ul></li></ul><p>So if you have used <b>2.4</b> and older before, you need to check your dependencies when upgrading to <b>2.5</b>.</p><ul><li>The <b>2.5</b> plugin can pick up and declare more module dependencies than the previous version. Module dependencies are safe. You either declared them in your <tt>module.xml</tt> file. Some additional ones can appear if you have them as direct dependencies in your pom. Use the <a class="externalLink" href="http://maven.apache.org/plugins/maven-dependency-plugin/analyze-mojo.html"><tt>dependency:analyze</tt></a> goal to check for used/unused direct dependencies.</li><li>The <b>2.5</b> plugin can also pick up and declare more module libraries. That's something to watch out for! That happens again only when you declared the jars as direct dependencies. You could end up with a single jar being added to multiple modules and get runtime classpath issues and of course your download size will get higher than necessary. Again the <a class="externalLink" href="http://maven.apache.org/plugins/maven-dependency-plugin/analyze-mojo.html"><tt>dependency:analyze</tt></a> goal shall help. If you know the jar is required but is provided by a module you depend on, use the <tt>provided</tt> scope to prevent inclusion.</li></ul></div>
                  </div>
            </div>
      
    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span16">Copyright &copy;                    2005-2015
                        <a href="http://codehaus.org">Codehaus</a>.
            All Rights Reserved.      
                    
      </div>

        
        
          
    
    
                
    <div id="ohloh" class="pull-right">
      <script type="text/javascript" src="http://www.ohloh.net/p/5211/widgets/project_thin_badge.js"></script>
    </div>
        </div>
    </footer>
  </body>
</html>
